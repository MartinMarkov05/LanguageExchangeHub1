@using Core;
@model Biz.Models.Models.Courses.CourseViewModel

<link rel="stylesheet" href="~/css/Chat.css" type="text/css" />

<nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3" id="courseNav">
    <h1>@Model.Name</h1>
    <form asp-action="CourseAssignments" asp-controller="Course">

        <input type="submit" value="Assignments" />
        <input type="hidden" name="courseId" value="@Model.Id" />
    </form>
</nav>

<div class="container">

    <div class="row chat-window" id="chat_window_1" style="margin-left:10px;">
        <div class="panel panel-default">
            <div class="panel-body msg_container_base">
                @foreach (var message in Model.Messages)
                {
                    if (message.IsMine)
                    {
                        <div class="row msg_container base_sent">
                            <div class="col-md-10 col-xs-10">
                                <div class="messages msg_sent">
                                    <p>
                                        @message.Text
                                    </p>
                                    <time>@message.Username • @message.Date.ToString("dd/MM/yy HH:mm")</time>
                                </div>
                            </div>
                            <div class="col-md-2 col-xs-2 avatar">
                                <img src="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-1.jpg" class=" img-responsive ">
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="row msg_container base_receive">
                            <div class="col-md-2 col-xs-2 avatar">
                                <img src="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-1.jpg" class=" img-responsive ">
                            </div>
                            <div class="col-md-10 col-xs-10">
                                <div class="messages msg_receive">
                                    <p>
                                        @message.Text
                                    </p>
                                    <time>@message.Username • @message.Date.ToString("dd/MM/yy HH:mm")</time>
                                </div>
                            </div>
                        </div>
                    }

                }

            </div>
            <form asp-action="SendMessage" asp-controller="Course">
                <input class="userInput" name="userInput" />
                <input type="hidden" name="courseId" value="@Model.Id" />
                <input type="submit" value="Send" />
            </form>
        </div>


    </div>




    <table class="table table-bordered table-responsive table-hover" id="membersTable">
        <tr>
            <th>Members</th>
        </tr>
      
            @foreach (var item in Model.Members)
            {
            <tr>
                <td>@item.Username</td>
            </tr>

            }
        

    </table>

    <table class="table table-bordered table-responsive table-hover" id="requestTable">
        <tr>
            <th>Requets</th>
        </tr>
        @foreach (var item in Model.Requests)
        {
            <tr>
                <td>
                    <div style="display: inline-block;">@item.Username</div>
                    @{
                        var loggedUser = ViewBag.loggedUser.Result;
                    }
                    @if (Model.UserId == loggedUser.Id)
                    {
                        <div style="display: inline-block;">
                            <form asp-action="Reject" asp-controller="Course">

                                <input type="hidden" name="requestStatus" value="2" />
                                <input type="hidden" name="requestId" value="@item.Id" />
                                <input type="hidden" name="courseId" value="@Model.Id" />
                                <input type="submit" value="Reject" />
                            </form>
                        </div>



                        <div style="display: inline-block;">
                            <form asp-action="Approve" asp-controller="Course" method="post">

                                <input type="hidden" name="requestStatus" value="1" />
                                <input type="hidden" name="requestId" value="@item.Id" />
                                <input type="hidden" name="courseId" value="@Model.Id" />
                                <input type="submit" value="Approve" />
                            </form>
                        </div>



                    }
                </td>
            </tr>

        }
    </table>

    </div>


       


    <script>function showMembers() {
            var membersList = document.getElementsByClassName('membersList');
            for (var i = 0; i < membersList.length; i++) {
                membersList[i].style.display = 'block';
            }
            closeRequests();
        }

        function showRequests() {
            var requestList = document.getElementsByClassName('requestList');
            for (var i = 0; i < requestList.length; i++) {
                requestList[i].style.display = 'block';
            }

            closeMembers();
        }
        function closeRequests() {
            var requestList = document.getElementsByClassName('requestList');
            for (var i = 0; i < requestList.length; i++) {
                requestList[i].style.display = 'none';
            }
        }

        function closeMembers() {
            var requestList = document.getElementsByClassName('membersList');
            for (var i = 0; i < requestList.length; i++) {
                requestList[i].style.display = 'none';
            }
        }</script>